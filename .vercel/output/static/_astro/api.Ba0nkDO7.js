const s="http://192.168.1.67:8051/api/MemesSoundBoard";async function i(n,o={},e){try{const r=`${s}${n}`,t={"Content-Type":"application/json",...o.headers||{}};e&&(t.Authorization=`Token ${e}`);const a=await fetch(r,{...o,headers:t});if(!a.ok)throw new Error(`API error: ${a.statusText}`);return await a.json()}catch(r){return console.error("API fetch error:",r),null}}async function c(n){try{const o=`${s}/user/register`,e=await fetch(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!e.ok){const t=await e.json().catch(()=>({}));throw new Error(t.message||`Registration failed: ${e.statusText}`)}const r=await e.json();if(r&&typeof r=="object"){if("data"in r&&r.data)return r.data;if("token"in r&&"user"in r)return r}return console.error("Unexpected registration response format:",r),null}catch(o){throw console.error("Registration error:",o),o}}async function l(n){try{const o=`${s}/user/login`,e=await fetch(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!e.ok){const t=await e.json().catch(()=>({}));throw new Error(t.message||`Login failed: ${e.statusText}`)}const r=await e.json();if(r&&typeof r=="object"){if("data"in r&&r.data)return r.data;if("token"in r&&"user"in r)return r}return console.error("Unexpected login response format:",r),null}catch(o){throw console.error("Login error:",o),o}}async function f(n){try{const o=`${s}/user/profile`,e=await fetch(o,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Token ${n}`}});if(!e.ok)return console.error(`Profile fetch error: ${e.status} ${e.statusText}`),null;const r=await e.json();if(r&&typeof r=="object"){if("data"in r&&r.data)return r.data;if("id"in r&&"username"in r)return r}return console.error("Unexpected profile response format:",r),null}catch(o){return console.error("Profile fetch error:",o),null}}async function d(n,o){try{const e=`${s}/user/profile`,r=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Token ${n}`},body:JSON.stringify(o)});if(!r.ok)return console.error(`Profile update error: ${r.status} ${r.statusText}`),null;const t=await r.json();if(t&&typeof t=="object"){if("data"in t&&t.data&&"user"in t.data)return t.data.user;if("user"in t&&t.user)return t.user;if("id"in t&&"username"in t)return t}return console.error("Unexpected profile update response format:",t),null}catch(e){return console.error("Profile update error:",e),null}}async function p(n,o=1,e=100){const r=await i(`/sounds/user/favorites?page=${o}&page_size=${e}`,{method:"GET"},n);return r&&"results"in r?r:{count:0,next:null,previous:null,results:[]}}async function h(n,o=1,e=100){const r=await i(`/sounds/user/uploaded?page=${o}&page_size=${e}`,{method:"GET"},n);return r&&"results"in r?r:{count:0,next:null,previous:null,results:[]}}async function y(n,o){try{const e=`${s}/sounds/${o}/favorite`,r=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Token ${n}`}});if(!r.ok)throw new Error(`API error: ${r.statusText}`);return!0}catch(e){return console.error("Add to favorites error:",e),!1}}async function w(n,o){try{const e=`${s}/sounds/${o}/favorite`,r=await fetch(e,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Token ${n}`}});if(!r.ok)throw new Error(`API error: ${r.statusText}`);return!0}catch(e){return console.error("Remove from favorites error:",e),!1}}async function T(n,o){try{const e=`${s}/sounds`,r=await fetch(e,{method:"POST",headers:{Authorization:`Token ${n}`},body:o});if(!r.ok)throw new Error(`API error: ${r.statusText}`);const t=await r.json();if(t&&typeof t=="object"){if("data"in t&&t.data)return t.data;if("id"in t&&"name"in t)return t}return console.warn("Unexpected upload response format:",t),null}catch(e){return console.error("Upload error:",e),null}}export{s as API_BASE_URL,y as addToFavorites,p as fetchUserFavorites,h as fetchUserUploadedSounds,f as getUserProfile,l as loginUser,c as registerUser,w as removeFromFavorites,d as updateUserProfile,T as uploadSound};
